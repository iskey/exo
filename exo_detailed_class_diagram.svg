<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="1268px" preserveAspectRatio="none" style="width:5612px;height:1268px;background:#FFFFFF;" version="1.1" viewBox="0 0 5612 1268" width="5612px" zoomAndPan="magnify"><defs/><g><!--class InferenceEngine--><g class="entity" data-entity="InferenceEngine" data-source-line="4" data-uid="ent0002" id="entity_InferenceEngine"><rect fill="#F1F1F1" height="178.375" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="766.1816" x="1411.32" y="713.32"/><ellipse cx="1733.1218" cy="729.32" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1733.2311,724.6638 L1732.0749,729.7419 L1734.403,729.7419 L1733.2311,724.6638 Z M1731.7468,722.4294 L1734.7311,722.4294 L1738.0905,734.82 L1735.6374,734.82 L1734.8718,731.7575 L1731.5905,731.7575 L1730.8405,734.82 L1728.403,734.82 L1731.7468,722.4294 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="114.0781" x="1753.6218" y="734.1667">InferenceEngine</text><line style="stroke:#181818;stroke-width:0.5;" x1="1412.32" x2="2176.5016" y1="745.32" y2="745.32"/><ellipse cx="1422.32" cy="758.9684" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.9531" x="1431.32" y="762.3151">session: dict</text><line style="stroke:#181818;stroke-width:0.5;" x1="1412.32" x2="2176.5016" y1="769.6169" y2="769.6169"/><ellipse cx="1422.32" cy="783.2653" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="404.9814" x="1431.32" y="786.612">encode(shard: Shard, prompt: str): np.ndarray &#171;abstract&#187;</text><ellipse cx="1422.32" cy="799.5622" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="321.6445" x="1431.32" y="802.9089">sample(x: np.ndarray): np.ndarray &#171;abstract&#187;</text><ellipse cx="1422.32" cy="815.8591" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="400.7158" x="1431.32" y="819.2057">decode(shard: Shard, tokens: np.ndarray): str &#171;abstract&#187;</text><ellipse cx="1422.32" cy="832.1559" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="740.1816" x="1431.32" y="835.5026">infer_tensor(request_id: str, shard: Shard, input_data: np.ndarray, inference_state: dict): tuple &#171;abstract&#187;</text><ellipse cx="1422.32" cy="848.4528" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="585.751" x="1431.32" y="851.7995">infer_prompt(request_id: str, shard: Shard, prompt: str, inference_state: dict): tuple</text><ellipse cx="1422.32" cy="864.7497" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="400.6543" x="1431.32" y="868.0964">load_checkpoint(shard: Shard, path: str): void &#171;abstract&#187;</text><ellipse cx="1422.32" cy="881.0466" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="324.1533" x="1431.32" y="884.3932">save_checkpoint(shard: Shard, path: str): void</text></g><!--class Discovery--><g class="entity" data-entity="Discovery" data-source-line="15" data-uid="ent0003" id="entity_Discovery"><rect fill="#F1F1F1" height="96.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="476.0234" x="2845.4" y="754.06"/><ellipse cx="3044.5787" cy="770.06" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M3044.6881,765.4038 L3043.5318,770.4819 L3045.86,770.4819 L3044.6881,765.4038 Z M3043.2037,763.1694 L3046.1881,763.1694 L3049.5475,775.56 L3047.0943,775.56 L3046.3287,772.4975 L3043.0475,772.4975 L3042.2975,775.56 L3039.86,775.56 L3043.2037,763.1694 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="69.166" x="3065.0787" y="774.9067">Discovery</text><line style="stroke:#181818;stroke-width:0.5;" x1="2846.4" x2="3320.4234" y1="786.06" y2="786.06"/><line style="stroke:#181818;stroke-width:0.5;" x1="2846.4" x2="3320.4234" y1="794.06" y2="794.06"/><ellipse cx="2856.4" cy="807.7084" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161.6768" x="2865.4" y="811.0551">start(): void &#171;abstract&#187;</text><ellipse cx="2856.4" cy="824.0053" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159.3047" x="2865.4" y="827.352">stop(): void &#171;abstract&#187;</text><ellipse cx="2856.4" cy="840.3022" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="450.0234" x="2865.4" y="843.6489">discover_peers(wait_for_peers: int): List[PeerHandle] &#171;abstract&#187;</text></g><!--class PeerHandle--><g class="entity" data-entity="PeerHandle" data-source-line="21" data-uid="ent0004" id="entity_PeerHandle"><rect fill="#F1F1F1" height="243.5625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="591.1338" x="3356.85" y="680.72"/><ellipse cx="3607.7699" cy="696.72" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M3607.8793,692.0638 L3606.723,697.1419 L3609.0512,697.1419 L3607.8793,692.0638 Z M3606.3949,689.8294 L3609.3793,689.8294 L3612.7387,702.22 L3610.2855,702.22 L3609.5199,699.1575 L3606.2387,699.1575 L3605.4887,702.22 L3603.0512,702.22 L3606.3949,689.8294 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="80.7939" x="3628.2699" y="701.5667">PeerHandle</text><line style="stroke:#181818;stroke-width:0.5;" x1="3357.85" x2="3946.9838" y1="712.72" y2="712.72"/><line style="stroke:#181818;stroke-width:0.5;" x1="3357.85" x2="3946.9838" y1="720.72" y2="720.72"/><ellipse cx="3367.85" cy="734.3684" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130.7578" x="3376.85" y="737.7151">id(): str &#171;abstract&#187;</text><ellipse cx="3367.85" cy="750.6653" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.0898" x="3376.85" y="754.012">addr(): str &#171;abstract&#187;</text><ellipse cx="3367.85" cy="766.9622" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.8223" x="3376.85" y="770.3089">description(): str &#171;abstract&#187;</text><ellipse cx="3367.85" cy="783.2591" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="361.5527" x="3376.85" y="786.6057">device_capabilities(): DeviceCapabilities &#171;abstract&#187;</text><ellipse cx="3367.85" cy="799.5559" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184.8779" x="3376.85" y="802.9026">connect(): void &#171;abstract&#187;</text><ellipse cx="3367.85" cy="815.8528" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220.8418" x="3376.85" y="819.1995">is_connected(): bool &#171;abstract&#187;</text><ellipse cx="3367.85" cy="832.1497" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204.9482" x="3376.85" y="835.4964">disconnect(): void &#171;abstract&#187;</text><ellipse cx="3367.85" cy="848.4466" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="221.6553" x="3376.85" y="851.7932">health_check(): bool &#171;abstract&#187;</text><ellipse cx="3367.85" cy="864.7434" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="537.7695" x="3376.85" y="868.0901">send_prompt(shard: Shard, prompt: str, request_id: str): np.array &#171;abstract&#187;</text><ellipse cx="3367.85" cy="881.0403" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="565.1338" x="3376.85" y="884.387">send_tensor(shard: Shard, tensor: np.array, request_id: str): np.array &#171;abstract&#187;</text><ellipse cx="3367.85" cy="897.3372" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="543.6963" x="3376.85" y="900.6839">send_result(request_id: str, result: List[int], is_finished: bool): void &#171;abstract&#187;</text><ellipse cx="3367.85" cy="913.6341" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="469.0957" x="3376.85" y="916.9807">collect_topology(visited: set, max_depth: int): Topology &#171;abstract&#187;</text></g><!--class MLXDynamicShardInferenceEngine--><g class="entity" data-entity="MLXDynamicShardInferenceEngine" data-source-line="37" data-uid="ent0005" id="entity_MLXDynamicShardInferenceEngine"><rect fill="#F1F1F1" height="276.1563" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="686.8301" x="7" y="985.28"/><ellipse cx="223.0293" cy="1001.28" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M225.998,1006.9206 Q225.4199,1007.2175 224.7793,1007.3581 Q224.1387,1007.5144 223.4355,1007.5144 Q220.9355,1007.5144 219.6074,1005.8738 Q218.2949,1004.2175 218.2949,1001.0925 Q218.2949,997.9675 219.6074,996.3113 Q220.9355,994.655 223.4355,994.655 Q224.1387,994.655 224.7793,994.8113 Q225.4355,994.9675 225.998,995.2644 L225.998,997.9831 Q225.373,997.405 224.7793,997.1394 Q224.1855,996.8581 223.5605,996.8581 Q222.2168,996.8581 221.5293,997.9363 Q220.8418,998.9988 220.8418,1001.0925 Q220.8418,1003.1863 221.5293,1004.2644 Q222.2168,1005.3269 223.5605,1005.3269 Q224.1855,1005.3269 224.7793,1005.0613 Q225.373,1004.78 225.998,1004.2019 L225.998,1006.9206 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="246.2715" x="243.5293" y="1006.1267">MLXDynamicShardInferenceEngine</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="692.8301" y1="1017.28" y2="1017.28"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1027.9284"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="262.5615" x="27" y="1034.2751">shard_downloader: ShardDownloader</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1044.2253"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.5371" x="27" y="1050.572">shard: Shard</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1060.5222"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.4951" x="27" y="1066.8689">model: Any</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1076.8191"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.1582" x="27" y="1083.1657">tokenizer: Any</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1093.1159"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143.3086" x="27" y="1099.4626">caches: OrderedDict</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1109.4128"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.9531" x="27" y="1115.7595">session: dict</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1125.7097"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="236.0244" x="27" y="1132.0564">_mlx_thread: ThreadPoolExecutor</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="692.8301" y1="1139.3581" y2="1139.3581"/><ellipse cx="18" cy="1153.0066" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="325.6299" x="27" y="1156.3532">encode(shard: Shard, prompt: str): np.ndarray</text><ellipse cx="18" cy="1169.3034" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="242.293" x="27" y="1172.6501">sample(x: np.ndarray): np.ndarray</text><ellipse cx="18" cy="1185.6003" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="321.3643" x="27" y="1188.947">decode(shard: Shard, tokens: np.ndarray): str</text><ellipse cx="18" cy="1201.8972" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="660.8301" x="27" y="1205.2439">infer_tensor(request_id: str, shard: Shard, input_data: np.ndarray, inference_state: dict): tuple</text><ellipse cx="18" cy="1218.1941" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="321.3027" x="27" y="1221.5407">load_checkpoint(shard: Shard, path: str): void</text><ellipse cx="18" cy="1234.4909" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233.666" x="27" y="1237.8376">ensure_shard(shard: Shard): void</text><ellipse cx="18" cy="1250.7878" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="546.2393" x="27" y="1254.1345">train(request_id: str, shard: Shard, inputs, targets, lengths, loss, opt, lr): tuple</text></g><!--class TinygradDynamicShardInferenceEngine--><g class="entity" data-entity="TinygradDynamicShardInferenceEngine" data-source-line="54" data-uid="ent0006" id="entity_TinygradDynamicShardInferenceEngine"><rect fill="#F1F1F1" height="259.8594" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="686.8301" x="729" y="993.43"/><ellipse cx="928.9102" cy="1009.43" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M931.8789,1015.0706 Q931.3008,1015.3675 930.6602,1015.5081 Q930.0195,1015.6644 929.3164,1015.6644 Q926.8164,1015.6644 925.4883,1014.0238 Q924.1758,1012.3675 924.1758,1009.2425 Q924.1758,1006.1175 925.4883,1004.4613 Q926.8164,1002.805 929.3164,1002.805 Q930.0195,1002.805 930.6602,1002.9613 Q931.3164,1003.1175 931.8789,1003.4144 L931.8789,1006.1331 Q931.2539,1005.555 930.6602,1005.2894 Q930.0664,1005.0081 929.4414,1005.0081 Q928.0977,1005.0081 927.4102,1006.0863 Q926.7227,1007.1488 926.7227,1009.2425 Q926.7227,1011.3363 927.4102,1012.4144 Q928.0977,1013.4769 929.4414,1013.4769 Q930.0664,1013.4769 930.6602,1013.2113 Q931.2539,1012.93 931.8789,1012.3519 L931.8789,1015.0706 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="278.5098" x="949.4102" y="1014.2767">TinygradDynamicShardInferenceEngine</text><line style="stroke:#181818;stroke-width:0.5;" x1="730" x2="1414.8301" y1="1025.43" y2="1025.43"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="737" y="1036.0784"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="262.5615" x="749" y="1042.4251">shard_downloader: ShardDownloader</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="737" y="1052.3753"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.5371" x="749" y="1058.722">shard: Shard</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="737" y="1068.6722"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139.0703" x="749" y="1075.0189">model: Transformer</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="737" y="1084.9691"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.1582" x="749" y="1091.3157">tokenizer: Any</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="737" y="1101.2659"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137.3135" x="749" y="1107.6126">states: OrderedDict</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="737" y="1117.5628"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="211.9072" x="749" y="1123.9095">executor: ThreadPoolExecutor</text><line style="stroke:#181818;stroke-width:0.5;" x1="730" x2="1414.8301" y1="1131.2113" y2="1131.2113"/><ellipse cx="740" cy="1144.8597" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="325.6299" x="749" y="1148.2064">encode(shard: Shard, prompt: str): np.ndarray</text><ellipse cx="740" cy="1161.1566" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="242.293" x="749" y="1164.5032">sample(x: np.ndarray): np.ndarray</text><ellipse cx="740" cy="1177.4534" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="321.3643" x="749" y="1180.8001">decode(shard: Shard, tokens: np.ndarray): str</text><ellipse cx="740" cy="1193.7503" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="660.8301" x="749" y="1197.097">infer_tensor(request_id: str, shard: Shard, input_data: np.ndarray, inference_state: dict): tuple</text><ellipse cx="740" cy="1210.0472" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="321.3027" x="749" y="1213.3939">load_checkpoint(shard: Shard, path: str): void</text><ellipse cx="740" cy="1226.3441" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="547.5996" x="749" y="1229.6907">evaluate(request_id: str, shard: Shard, inputs, targets, lengths, loss): np.array</text><ellipse cx="740" cy="1242.6409" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="546.2393" x="749" y="1245.9876">train(request_id: str, shard: Shard, inputs, targets, lengths, loss, opt, lr): tuple</text></g><!--class DummyInferenceEngine--><g class="entity" data-entity="DummyInferenceEngine" data-source-line="70" data-uid="ent0007" id="entity_DummyInferenceEngine"><rect fill="#F1F1F1" height="178.375" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="686.8301" x="1451" y="1034.17"/><ellipse cx="1705.519" cy="1050.17" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1708.4878,1055.8106 Q1707.9097,1056.1075 1707.269,1056.2481 Q1706.6284,1056.4044 1705.9253,1056.4044 Q1703.4253,1056.4044 1702.0972,1054.7638 Q1700.7847,1053.1075 1700.7847,1049.9825 Q1700.7847,1046.8575 1702.0972,1045.2013 Q1703.4253,1043.545 1705.9253,1043.545 Q1706.6284,1043.545 1707.269,1043.7013 Q1707.9253,1043.8575 1708.4878,1044.1544 L1708.4878,1046.8731 Q1707.8628,1046.295 1707.269,1046.0294 Q1706.6753,1045.7481 1706.0503,1045.7481 Q1704.7065,1045.7481 1704.019,1046.8263 Q1703.3315,1047.8888 1703.3315,1049.9825 Q1703.3315,1052.0763 1704.019,1053.1544 Q1704.7065,1054.2169 1706.0503,1054.2169 Q1706.6753,1054.2169 1707.269,1053.9513 Q1707.8628,1053.67 1708.4878,1053.0919 L1708.4878,1055.8106 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169.292" x="1726.019" y="1055.0167">DummyInferenceEngine</text><line style="stroke:#181818;stroke-width:0.5;" x1="1452" x2="2136.8301" y1="1066.17" y2="1066.17"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1459" y="1076.8184"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.5371" x="1471" y="1083.1651">shard: Shard</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1459" y="1093.1153"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.5781" x="1471" y="1099.462">vocab_size: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1459" y="1109.4122"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.5869" x="1471" y="1115.7589">hidden_size: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1459" y="1125.7091"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="197.9551" x="1471" y="1132.0557">tokenizer: DummyTokenizer</text><line style="stroke:#181818;stroke-width:0.5;" x1="1452" x2="2136.8301" y1="1139.3575" y2="1139.3575"/><ellipse cx="1462" cy="1153.0059" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="325.6299" x="1471" y="1156.3526">encode(shard: Shard, prompt: str): np.ndarray</text><ellipse cx="1462" cy="1169.3028" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="242.293" x="1471" y="1172.6495">sample(x: np.ndarray): np.ndarray</text><ellipse cx="1462" cy="1185.5997" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="321.3643" x="1471" y="1188.9464">decode(shard: Shard, tokens: np.ndarray): str</text><ellipse cx="1462" cy="1201.8966" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="660.8301" x="1471" y="1205.2432">infer_tensor(request_id: str, shard: Shard, input_data: np.ndarray, inference_state: dict): tuple</text></g><!--class UDPDiscovery--><g class="entity" data-entity="UDPDiscovery" data-source-line="82" data-uid="ent0008" id="entity_UDPDiscovery"><rect fill="#F1F1F1" height="210.9688" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="396.6719" x="2427.08" y="1017.88"/><ellipse cx="2571.8481" cy="1033.88" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M2574.8168,1039.5206 Q2574.2387,1039.8175 2573.5981,1039.9581 Q2572.9574,1040.1144 2572.2543,1040.1144 Q2569.7543,1040.1144 2568.4262,1038.4738 Q2567.1137,1036.8175 2567.1137,1033.6925 Q2567.1137,1030.5675 2568.4262,1028.9113 Q2569.7543,1027.255 2572.2543,1027.255 Q2572.9574,1027.255 2573.5981,1027.4113 Q2574.2543,1027.5675 2574.8168,1027.8644 L2574.8168,1030.5831 Q2574.1918,1030.005 2573.5981,1029.7394 Q2573.0043,1029.4581 2572.3793,1029.4581 Q2571.0356,1029.4581 2570.3481,1030.5363 Q2569.6606,1031.5988 2569.6606,1033.6925 Q2569.6606,1035.7863 2570.3481,1036.8644 Q2571.0356,1037.9269 2572.3793,1037.9269 Q2573.0043,1037.9269 2573.5981,1037.6613 Q2574.1918,1037.38 2574.8168,1036.8019 L2574.8168,1039.5206 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6357" x="2592.3481" y="1038.7267">UDPDiscovery</text><line style="stroke:#181818;stroke-width:0.5;" x1="2428.08" x2="2822.7519" y1="1049.88" y2="1049.88"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2435.08" y="1060.5284"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.4209" x="2447.08" y="1066.8751">node_id: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2435.08" y="1076.8253"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.0547" x="2447.08" y="1083.172">node_port: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2435.08" y="1093.1222"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.165" x="2447.08" y="1099.4689">listen_port: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2435.08" y="1109.4191"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.8496" x="2447.08" y="1115.7657">broadcast_port: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2435.08" y="1125.7159"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="206.2334" x="2447.08" y="1132.0626">known_peers: Dict[str, Tuple]</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2435.08" y="1142.0128"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147.9023" x="2447.08" y="1148.3595">broadcast_task: Task</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2435.08" y="1158.3097"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.2178" x="2447.08" y="1164.6564">listen_task: Task</text><line style="stroke:#181818;stroke-width:0.5;" x1="2428.08" x2="2822.7519" y1="1171.9581" y2="1171.9581"/><ellipse cx="2438.08" cy="1185.6066" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.3252" x="2447.08" y="1188.9532">start(): void</text><ellipse cx="2438.08" cy="1201.9034" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.9531" x="2447.08" y="1205.2501">stop(): void</text><ellipse cx="2438.08" cy="1218.2003" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="370.6719" x="2447.08" y="1221.547">discover_peers(wait_for_peers: int): List[PeerHandle]</text></g><!--class TailscaleDiscovery--><g class="entity" data-entity="TailscaleDiscovery" data-source-line="95" data-uid="ent0009" id="entity_TailscaleDiscovery"><rect fill="#F1F1F1" height="210.9688" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="396.6719" x="2859.08" y="1017.88"/><ellipse cx="2988.0912" cy="1033.88" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M2991.06,1039.5206 Q2990.4819,1039.8175 2989.8412,1039.9581 Q2989.2006,1040.1144 2988.4975,1040.1144 Q2985.9975,1040.1144 2984.6694,1038.4738 Q2983.3569,1036.8175 2983.3569,1033.6925 Q2983.3569,1030.5675 2984.6694,1028.9113 Q2985.9975,1027.255 2988.4975,1027.255 Q2989.2006,1027.255 2989.8412,1027.4113 Q2990.4975,1027.5675 2991.06,1027.8644 L2991.06,1030.5831 Q2990.435,1030.005 2989.8412,1029.7394 Q2989.2475,1029.4581 2988.6225,1029.4581 Q2987.2787,1029.4581 2986.5912,1030.5363 Q2985.9037,1031.5988 2985.9037,1033.6925 Q2985.9037,1035.7863 2986.5912,1036.8644 Q2987.2787,1037.9269 2988.6225,1037.9269 Q2989.2475,1037.9269 2989.8412,1037.6613 Q2990.435,1037.38 2991.06,1036.8019 L2991.06,1039.5206 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130.1494" x="3008.5912" y="1038.7267">TailscaleDiscovery</text><line style="stroke:#181818;stroke-width:0.5;" x1="2860.08" x2="3254.7519" y1="1049.88" y2="1049.88"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2867.08" y="1060.5284"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.4209" x="2879.08" y="1066.8751">node_id: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2867.08" y="1076.8253"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.0547" x="2879.08" y="1083.172">node_port: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2867.08" y="1093.1222"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145.9883" x="2879.08" y="1099.4689">tailscale_api_key: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2867.08" y="1109.4191"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.5293" x="2879.08" y="1115.7657">tailnet: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2867.08" y="1125.7159"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="206.2334" x="2879.08" y="1132.0626">known_peers: Dict[str, Tuple]</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2867.08" y="1142.0128"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145.4414" x="2879.08" y="1148.3595">discovery_task: Task</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2867.08" y="1158.3097"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133.5811" x="2879.08" y="1164.6564">cleanup_task: Task</text><line style="stroke:#181818;stroke-width:0.5;" x1="2860.08" x2="3254.7519" y1="1171.9581" y2="1171.9581"/><ellipse cx="2870.08" cy="1185.6066" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.3252" x="2879.08" y="1188.9532">start(): void</text><ellipse cx="2870.08" cy="1201.9034" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.9531" x="2879.08" y="1205.2501">stop(): void</text><ellipse cx="2870.08" cy="1218.2003" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="370.6719" x="2879.08" y="1221.547">discover_peers(wait_for_peers: int): List[PeerHandle]</text></g><!--class ManualDiscovery--><g class="entity" data-entity="ManualDiscovery" data-source-line="108" data-uid="ent0010" id="entity_ManualDiscovery"><rect fill="#F1F1F1" height="162.0781" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="396.6719" x="3291.08" y="1042.32"/><ellipse cx="3425.1464" cy="1058.32" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M3428.1152,1063.9606 Q3427.537,1064.2575 3426.8964,1064.3981 Q3426.2558,1064.5544 3425.5527,1064.5544 Q3423.0527,1064.5544 3421.7245,1062.9138 Q3420.412,1061.2575 3420.412,1058.1325 Q3420.412,1055.0075 3421.7245,1053.3513 Q3423.0527,1051.695 3425.5527,1051.695 Q3426.2558,1051.695 3426.8964,1051.8513 Q3427.5527,1052.0075 3428.1152,1052.3044 L3428.1152,1055.0231 Q3427.4902,1054.445 3426.8964,1054.1794 Q3426.3027,1053.8981 3425.6777,1053.8981 Q3424.3339,1053.8981 3423.6464,1054.9763 Q3422.9589,1056.0388 3422.9589,1058.1325 Q3422.9589,1060.2263 3423.6464,1061.3044 Q3424.3339,1062.3669 3425.6777,1062.3669 Q3426.3027,1062.3669 3426.8964,1062.1013 Q3427.4902,1061.82 3428.1152,1061.2419 L3428.1152,1063.9606 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.0391" x="3445.6464" y="1063.1667">ManualDiscovery</text><line style="stroke:#181818;stroke-width:0.5;" x1="3292.08" x2="3686.7519" y1="1074.32" y2="1074.32"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3299.08" y="1084.9684"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173.2295" x="3311.08" y="1091.3151">network_config_path: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3299.08" y="1101.2653"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.4209" x="3311.08" y="1107.612">node_id: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3299.08" y="1117.5622"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="248.2129" x="3311.08" y="1123.9089">known_peers: Dict[str, PeerHandle]</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3299.08" y="1133.8591"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.2178" x="3311.08" y="1140.2057">listen_task: Task</text><line style="stroke:#181818;stroke-width:0.5;" x1="3292.08" x2="3686.7519" y1="1147.5075" y2="1147.5075"/><ellipse cx="3302.08" cy="1161.1559" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.3252" x="3311.08" y="1164.5026">start(): void</text><ellipse cx="3302.08" cy="1177.4528" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.9531" x="3311.08" y="1180.7995">stop(): void</text><ellipse cx="3302.08" cy="1193.7497" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="370.6719" x="3311.08" y="1197.0964">discover_peers(wait_for_peers: int): List[PeerHandle]</text></g><!--class GRPCServer--><g class="entity" data-entity="GRPCServer" data-source-line="119" data-uid="ent0011" id="entity_GRPCServer"><rect fill="#F1F1F1" height="210.9688" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="337.541" x="4024.64" y="7"/><ellipse cx="4146.8085" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4149.7772,28.6406 Q4149.1991,28.9375 4148.5585,29.0781 Q4147.9178,29.2344 4147.2147,29.2344 Q4144.7147,29.2344 4143.3866,27.5938 Q4142.0741,25.9375 4142.0741,22.8125 Q4142.0741,19.6875 4143.3866,18.0313 Q4144.7147,16.375 4147.2147,16.375 Q4147.9178,16.375 4148.5585,16.5313 Q4149.2147,16.6875 4149.7772,16.9844 L4149.7772,19.7031 Q4149.1522,19.125 4148.5585,18.8594 Q4147.9647,18.5781 4147.3397,18.5781 Q4145.996,18.5781 4145.3085,19.6563 Q4144.621,20.7188 4144.621,22.8125 Q4144.621,24.9063 4145.3085,25.9844 Q4145.996,27.0469 4147.3397,27.0469 Q4147.9647,27.0469 4148.5585,26.7813 Q4149.1522,26.5 4149.7772,25.9219 L4149.7772,28.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.7041" x="4167.3085" y="27.8467">GRPCServer</text><line style="stroke:#181818;stroke-width:0.5;" x1="4025.64" x2="4361.181" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4032.64" y="49.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.6436" x="4044.64" y="55.9951">node: Node</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4032.64" y="65.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.9277" x="4044.64" y="72.292">host: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4032.64" y="82.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.1162" x="4044.64" y="88.5889">port: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4032.64" y="98.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.9629" x="4044.64" y="104.8857">server: grpc.aio.server</text><line style="stroke:#181818;stroke-width:0.5;" x1="4025.64" x2="4361.181" y1="112.1875" y2="112.1875"/><ellipse cx="4035.64" cy="125.8359" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.3252" x="4044.64" y="129.1826">start(): void</text><ellipse cx="4035.64" cy="142.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.9531" x="4044.64" y="145.4795">stop(): void</text><ellipse cx="4035.64" cy="158.4297" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="285.4619" x="4044.64" y="161.7764">SendPrompt(request, context): response</text><ellipse cx="4035.64" cy="174.7266" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="282.3379" x="4044.64" y="178.0732">SendTensor(request, context): response</text><ellipse cx="4035.64" cy="191.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="278.5713" x="4044.64" y="194.3701">SendResult(request, context): response</text><ellipse cx="4035.64" cy="207.3203" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="311.541" x="4044.64" y="210.667">CollectTopology(request, context): response</text></g><!--class GRPCPeerHandle--><g class="entity" data-entity="GRPCPeerHandle" data-source-line="132" data-uid="ent0012" id="entity_GRPCPeerHandle"><rect fill="#F1F1F1" height="276.1563" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="511.7822" x="3722.52" y="985.28"/><ellipse cx="3914.3672" cy="1001.28" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M3917.3359,1006.9206 Q3916.7578,1007.2175 3916.1172,1007.3581 Q3915.4765,1007.5144 3914.7734,1007.5144 Q3912.2734,1007.5144 3910.9453,1005.8738 Q3909.6328,1004.2175 3909.6328,1001.0925 Q3909.6328,997.9675 3910.9453,996.3113 Q3912.2734,994.655 3914.7734,994.655 Q3915.4765,994.655 3916.1172,994.8113 Q3916.7734,994.9675 3917.3359,995.2644 L3917.3359,997.9831 Q3916.7109,997.405 3916.1172,997.1394 Q3915.5234,996.8581 3914.8984,996.8581 Q3913.5547,996.8581 3912.8672,997.9363 Q3912.1797,998.9988 3912.1797,1001.0925 Q3912.1797,1003.1863 3912.8672,1004.2644 Q3913.5547,1005.3269 3914.8984,1005.3269 Q3915.5234,1005.3269 3916.1172,1005.0613 Q3916.7109,1004.78 3917.3359,1004.2019 L3917.3359,1006.9206 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.5879" x="3934.8672" y="1006.1267">GRPCPeerHandle</text><line style="stroke:#181818;stroke-width:0.5;" x1="3723.52" x2="4233.3022" y1="1017.28" y2="1017.28"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3730.52" y="1027.9284"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.3516" x="3742.52" y="1034.2751">peer_id: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3730.52" y="1044.2253"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.0156" x="3742.52" y="1050.572">address: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3730.52" y="1060.5222"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.5469" x="3742.52" y="1066.8689">description: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3730.52" y="1076.8191"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271.2773" x="3742.52" y="1083.1657">device_capabilities: DeviceCapabilities</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3730.52" y="1093.1159"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183.2031" x="3742.52" y="1099.4626">channel: grpc.aio.Channel</text><line style="stroke:#181818;stroke-width:0.5;" x1="3723.52" x2="4233.3022" y1="1106.7644" y2="1106.7644"/><ellipse cx="3733.52" cy="1120.4128" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.4063" x="3742.52" y="1123.7595">id(): str</text><ellipse cx="3733.52" cy="1136.7097" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.7383" x="3742.52" y="1140.0564">addr(): str</text><ellipse cx="3733.52" cy="1153.0066" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.4707" x="3742.52" y="1156.3532">description(): str</text><ellipse cx="3733.52" cy="1169.3034" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="282.2012" x="3742.52" y="1172.6501">device_capabilities(): DeviceCapabilities</text><ellipse cx="3733.52" cy="1185.6003" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.5264" x="3742.52" y="1188.947">connect(): void</text><ellipse cx="3733.52" cy="1201.8972" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141.4902" x="3742.52" y="1205.2439">is_connected(): bool</text><ellipse cx="3733.52" cy="1218.1941" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.5967" x="3742.52" y="1221.5407">disconnect(): void</text><ellipse cx="3733.52" cy="1234.4909" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="458.418" x="3742.52" y="1237.8376">send_prompt(shard: Shard, prompt: str, request_id: str): np.array</text><ellipse cx="3733.52" cy="1250.7878" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="485.7822" x="3742.52" y="1254.1345">send_tensor(shard: Shard, tensor: np.array, request_id: str): np.array</text></g><!--class Node--><g class="entity" data-entity="Node" data-source-line="150" data-uid="ent0013" id="entity_Node"><rect fill="#F1F1F1" height="308.75" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="546.7002" x="3522.06" y="294.97"/><ellipse cx="3772.8911" cy="310.97" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M3775.8598,316.6106 Q3775.2817,316.9075 3774.6411,317.0481 Q3774.0004,317.2044 3773.2973,317.2044 Q3770.7973,317.2044 3769.4692,315.5638 Q3768.1567,313.9075 3768.1567,310.7825 Q3768.1567,307.6575 3769.4692,306.0013 Q3770.7973,304.345 3773.2973,304.345 Q3774.0004,304.345 3774.6411,304.5013 Q3775.2973,304.6575 3775.8598,304.9544 L3775.8598,307.6731 Q3775.2348,307.095 3774.6411,306.8294 Q3774.0473,306.5481 3773.4223,306.5481 Q3772.0786,306.5481 3771.3911,307.6263 Q3770.7036,308.6888 3770.7036,310.7825 Q3770.7036,312.8763 3771.3911,313.9544 Q3772.0786,315.0169 3773.4223,315.0169 Q3774.0473,315.0169 3774.6411,314.7513 Q3775.2348,314.47 3775.8598,313.8919 L3775.8598,316.6106 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.5381" x="3793.3911" y="315.8167">Node</text><line style="stroke:#181818;stroke-width:0.5;" x1="3523.06" x2="4067.7602" y1="326.97" y2="326.97"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="337.6184"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.4824" x="3542.06" y="343.9651">id: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="353.9153"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.3945" x="3542.06" y="360.262">server: Server</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="370.2122"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243.8516" x="3542.06" y="376.5589">inference_engine: InferenceEngine</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="386.5091"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145.6055" x="3542.06" y="392.8557">discovery: Discovery</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="402.8059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="262.5615" x="3542.06" y="409.1526">shard_downloader: ShardDownloader</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="419.1028"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.4971" x="3542.06" y="425.4495">topology: Topology</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="435.3997"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="296.2354" x="3542.06" y="441.7464">partitioning_strategy: PartitioningStrategy</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="451.6966"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.8359" x="3542.06" y="458.0432">topology_viz: TopologyViz</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="467.9934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164.5205" x="3542.06" y="474.3401">peers: List[PeerHandle]</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="484.2903"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271.2773" x="3542.06" y="490.637">device_capabilities: DeviceCapabilities</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="500.5872"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182.2871" x="3542.06" y="506.9339">max_generate_tokens: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="516.8841"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="226.5908" x="3542.06" y="523.2307">on_token: AsyncCallbackSystem</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3530.06" y="533.1809"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289.3652" x="3542.06" y="539.5276">on_opaque_status: AsyncCallbackSystem</text><ellipse cx="3533.06" cy="552.4778" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192.5547" x="3542.06" y="555.8245">current_topology: Topology</text><line style="stroke:#181818;stroke-width:0.5;" x1="3523.06" x2="4067.7602" y1="563.1263" y2="563.1263"/><ellipse cx="3533.06" cy="576.7747" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="449.3193" x="3542.06" y="580.1214">process_prompt(shard: Shard, prompt: str, request_id: str): void</text><ellipse cx="3533.06" cy="593.0716" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="520.7002" x="3542.06" y="596.4182">enqueue_example(shard: Shard, inputs, targets, lengths, train: bool): void</text></g><!--class ChatGPTAPI--><g class="entity" data-entity="ChatGPTAPI" data-source-line="170" data-uid="ent0014" id="entity_ChatGPTAPI"><rect fill="#F1F1F1" height="194.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388.8516" x="3600.99" y="15.15"/><ellipse cx="3749.8118" cy="31.15" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M3752.7805,36.7906 Q3752.2024,37.0875 3751.5618,37.2281 Q3750.9212,37.3844 3750.218,37.3844 Q3747.718,37.3844 3746.3899,35.7438 Q3745.0774,34.0875 3745.0774,30.9625 Q3745.0774,27.8375 3746.3899,26.1813 Q3747.718,24.525 3750.218,24.525 Q3750.9212,24.525 3751.5618,24.6813 Q3752.218,24.8375 3752.7805,25.1344 L3752.7805,27.8531 Q3752.1555,27.275 3751.5618,27.0094 Q3750.968,26.7281 3750.343,26.7281 Q3748.9993,26.7281 3748.3118,27.8063 Q3747.6243,28.8688 3747.6243,30.9625 Q3747.6243,33.0563 3748.3118,34.1344 Q3748.9993,35.1969 3750.343,35.1969 Q3750.968,35.1969 3751.5618,34.9313 Q3752.1555,34.65 3752.7805,34.0719 L3752.7805,36.7906 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.708" x="3770.3118" y="35.9967">ChatGPTAPI</text><line style="stroke:#181818;stroke-width:0.5;" x1="3601.99" x2="3988.8416" y1="47.15" y2="47.15"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3608.99" y="57.7984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.6436" x="3620.99" y="64.1451">node: Node</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3608.99" y="74.0953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="229.7695" x="3620.99" y="80.442">inference_engine_classname: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3608.99" y="90.3922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147.1436" x="3620.99" y="96.7389">app: web.Application</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3608.99" y="106.6891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.4541" x="3620.99" y="113.0357">prompts: PrefixDict</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3608.99" y="122.9859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="201.0518" x="3620.99" y="129.3326">stream_tasks: Dict[str, Task]</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3608.99" y="139.2828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182.1914" x="3620.99" y="145.6295">token_queues: defaultdict</text><line style="stroke:#181818;stroke-width:0.5;" x1="3601.99" x2="3988.8416" y1="152.9313" y2="152.9313"/><ellipse cx="3611.99" cy="166.5797" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="273.1025" x="3620.99" y="169.9264">handle_get_models(request): response</text><ellipse cx="3611.99" cy="182.8766" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="307.9727" x="3620.99" y="186.2232">handle_chat_completion(request): response</text><ellipse cx="3611.99" cy="199.1734" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="362.8516" x="3620.99" y="202.5201">handle_tokens(request_id, tokens, is_finished): void</text></g><!--class Shard--><g class="entity" data-entity="Shard" data-source-line="183" data-uid="ent0015" id="entity_Shard"><rect fill="#F1F1F1" height="194.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="219.5869" x="2172.62" y="1026.03"/><ellipse cx="2257.6727" cy="1042.03" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M2260.6415,1047.6706 Q2260.0634,1047.9675 2259.4227,1048.1081 Q2258.7821,1048.2644 2258.079,1048.2644 Q2255.579,1048.2644 2254.2509,1046.6238 Q2252.9384,1044.9675 2252.9384,1041.8425 Q2252.9384,1038.7175 2254.2509,1037.0613 Q2255.579,1035.405 2258.079,1035.405 Q2258.7821,1035.405 2259.4227,1035.5613 Q2260.079,1035.7175 2260.6415,1036.0144 L2260.6415,1038.7331 Q2260.0165,1038.155 2259.4227,1037.8894 Q2258.829,1037.6081 2258.204,1037.6081 Q2256.8602,1037.6081 2256.1727,1038.6863 Q2255.4852,1039.7488 2255.4852,1041.8425 Q2255.4852,1043.9363 2256.1727,1045.0144 Q2256.8602,1046.0769 2258.204,1046.0769 Q2258.829,1046.0769 2259.4227,1045.8113 Q2260.0165,1045.53 2260.6415,1044.9519 L2260.6415,1047.6706 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.9814" x="2278.1727" y="1046.8767">Shard</text><line style="stroke:#181818;stroke-width:0.5;" x1="2173.62" x2="2391.2069" y1="1058.03" y2="1058.03"/><ellipse cx="2183.62" cy="1071.6784" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.0752" x="2192.62" y="1075.0251">model_id: str</text><ellipse cx="2183.62" cy="1087.9753" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.1494" x="2192.62" y="1091.322">start_layer: int</text><ellipse cx="2183.62" cy="1104.2722" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.915" x="2192.62" y="1107.6189">end_layer: int</text><ellipse cx="2183.62" cy="1120.5691" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.709" x="2192.62" y="1123.9157">n_layers: int</text><line style="stroke:#181818;stroke-width:0.5;" x1="2173.62" x2="2391.2069" y1="1131.2175" y2="1131.2175"/><ellipse cx="2183.62" cy="1144.8659" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137.6621" x="2192.62" y="1148.2126">is_first_layer(): bool</text><ellipse cx="2183.62" cy="1161.1628" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.5566" x="2192.62" y="1164.5095">is_last_layer(): bool</text><ellipse cx="2183.62" cy="1177.4597" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.9531" x="2192.62" y="1180.8064">get_layer_count(): int</text><ellipse cx="2183.62" cy="1193.7566" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.0713" x="2192.62" y="1197.1032">to_dict(): dict</text><ellipse cx="2183.62" cy="1210.0534" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="193.5869" x="2192.62" y="1213.4001">from_dict(data: dict): Shard</text></g><!--class Topology--><g class="entity" data-entity="Topology" data-source-line="195" data-uid="ent0016" id="entity_Topology"><rect fill="#F1F1F1" height="162.0781" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="476.5977" x="3983.12" y="721.46"/><ellipse cx="4185.0707" cy="737.46" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4188.0394,743.1006 Q4187.4613,743.3975 4186.8207,743.5381 Q4186.1801,743.6944 4185.4769,743.6944 Q4182.9769,743.6944 4181.6488,742.0538 Q4180.3363,740.3975 4180.3363,737.2725 Q4180.3363,734.1475 4181.6488,732.4913 Q4182.9769,730.835 4185.4769,730.835 Q4186.1801,730.835 4186.8207,730.9913 Q4187.4769,731.1475 4188.0394,731.4444 L4188.0394,734.1631 Q4187.4144,733.585 4186.8207,733.3194 Q4186.2269,733.0381 4185.6019,733.0381 Q4184.2582,733.0381 4183.5707,734.1163 Q4182.8832,735.1788 4182.8832,737.2725 Q4182.8832,739.3663 4183.5707,740.4444 Q4184.2582,741.5069 4185.6019,741.5069 Q4186.2269,741.5069 4186.8207,741.2413 Q4187.4144,740.96 4188.0394,740.3819 L4188.0394,743.1006 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.1963" x="4205.5707" y="742.3067">Topology</text><line style="stroke:#181818;stroke-width:0.5;" x1="3984.12" x2="4458.7177" y1="753.46" y2="753.46"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3991.12" y="764.1084"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="247.1602" x="4003.12" y="770.4551">nodes: Dict[str, DeviceCapabilities]</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3991.12" y="780.4053"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="312.3271" x="4003.12" y="786.752">peer_graph: Dict[str, Set[PeerConnection&gt;&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3991.12" y="796.7022"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.9746" x="4003.12" y="803.0489">active_node_id: str</text><line style="stroke:#181818;stroke-width:0.5;" x1="3984.12" x2="4458.7177" y1="810.3506" y2="810.3506"/><ellipse cx="3994.12" cy="823.9991" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="450.5977" x="4003.12" y="827.3457">update_node(node_id: str, capabilities: DeviceCapabilities): void</text><ellipse cx="3994.12" cy="840.2959" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="383.3252" x="4003.12" y="843.6426">add_edge(from_id: str, to_id: str, description: str): void</text><ellipse cx="3994.12" cy="856.5928" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336.0752" x="4003.12" y="859.9395">merge(peer_node_id: str, other: Topology): void</text><ellipse cx="3994.12" cy="872.8897" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.7305" x="4003.12" y="876.2364">to_json(): dict</text></g><!--class Partition--><g class="entity" data-entity="Partition" data-source-line="205" data-uid="ent0017" id="entity_Partition"><rect fill="#F1F1F1" height="96.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.4209" x="4495.2" y="754.06"/><ellipse cx="4518.0513" cy="770.06" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4521.02,775.7006 Q4520.4419,775.9975 4519.8013,776.1381 Q4519.1606,776.2944 4518.4575,776.2944 Q4515.9575,776.2944 4514.6294,774.6538 Q4513.3169,772.9975 4513.3169,769.8725 Q4513.3169,766.7475 4514.6294,765.0913 Q4515.9575,763.435 4518.4575,763.435 Q4519.1606,763.435 4519.8013,763.5913 Q4520.4575,763.7475 4521.02,764.0444 L4521.02,766.7631 Q4520.395,766.185 4519.8013,765.9194 Q4519.2075,765.6381 4518.5825,765.6381 Q4517.2388,765.6381 4516.5513,766.7163 Q4515.8638,767.7788 4515.8638,769.8725 Q4515.8638,771.9663 4516.5513,773.0444 Q4517.2388,774.1069 4518.5825,774.1069 Q4519.2075,774.1069 4519.8013,773.8413 Q4520.395,773.56 4521.02,772.9819 L4521.02,775.7006 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.9736" x="4533.796" y="774.9067">Partition</text><line style="stroke:#181818;stroke-width:0.5;" x1="4496.2" x2="4602.6209" y1="786.06" y2="786.06"/><ellipse cx="4506.2" cy="799.7084" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.4209" x="4515.2" y="803.0551">node_id: str</text><ellipse cx="4506.2" cy="816.0053" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.2266" x="4515.2" y="819.352">start: float</text><ellipse cx="4506.2" cy="832.3022" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9922" x="4515.2" y="835.6489">end: float</text><line style="stroke:#181818;stroke-width:0.5;" x1="4496.2" x2="4602.6209" y1="842.9506" y2="842.9506"/></g><!--class DeviceCapabilities--><g class="entity" data-entity="DeviceCapabilities" data-source-line="211" data-uid="ent0018" id="entity_DeviceCapabilities"><rect fill="#F1F1F1" height="129.4844" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161.541" x="4269.64" y="1058.62"/><ellipse cx="4284.64" cy="1074.62" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4287.6088,1080.2606 Q4287.0306,1080.5575 4286.39,1080.6981 Q4285.7494,1080.8544 4285.0463,1080.8544 Q4282.5463,1080.8544 4281.2181,1079.2138 Q4279.9056,1077.5575 4279.9056,1074.4325 Q4279.9056,1071.3075 4281.2181,1069.6513 Q4282.5463,1067.995 4285.0463,1067.995 Q4285.7494,1067.995 4286.39,1068.1513 Q4287.0463,1068.3075 4287.6088,1068.6044 L4287.6088,1071.3231 Q4286.9838,1070.745 4286.39,1070.4794 Q4285.7963,1070.1981 4285.1713,1070.1981 Q4283.8275,1070.1981 4283.14,1071.2763 Q4282.4525,1072.3388 4282.4525,1074.4325 Q4282.4525,1076.5263 4283.14,1077.6044 Q4283.8275,1078.6669 4285.1713,1078.6669 Q4285.7963,1078.6669 4286.39,1078.4013 Q4286.9838,1078.12 4287.6088,1077.5419 L4287.6088,1080.2606 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.541" x="4298.64" y="1079.4667">DeviceCapabilities</text><line style="stroke:#181818;stroke-width:0.5;" x1="4270.64" x2="4430.181" y1="1090.62" y2="1090.62"/><ellipse cx="4280.64" cy="1104.2684" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.2988" x="4289.64" y="1107.6151">model: str</text><ellipse cx="4280.64" cy="1120.5653" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.0527" x="4289.64" y="1123.912">chip: str</text><ellipse cx="4280.64" cy="1136.8622" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.9141" x="4289.64" y="1140.2089">memory: int</text><ellipse cx="4280.64" cy="1153.1591" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.2988" x="4289.64" y="1156.5057">flops: DeviceFlops</text><line style="stroke:#181818;stroke-width:0.5;" x1="4270.64" x2="4430.181" y1="1163.8075" y2="1163.8075"/><ellipse cx="4280.64" cy="1177.4559" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.0713" x="4289.64" y="1180.8026">to_dict(): dict</text></g><!--class DeviceFlops--><g class="entity" data-entity="DeviceFlops" data-source-line="219" data-uid="ent0019" id="entity_DeviceFlops"><rect fill="#F1F1F1" height="113.1875" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.0713" x="4396.88" y="55.89"/><ellipse cx="4413.0068" cy="71.89" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4415.9755,77.5306 Q4415.3974,77.8275 4414.7568,77.9681 Q4414.1161,78.1244 4413.413,78.1244 Q4410.913,78.1244 4409.5849,76.4838 Q4408.2724,74.8275 4408.2724,71.7025 Q4408.2724,68.5775 4409.5849,66.9213 Q4410.913,65.265 4413.413,65.265 Q4414.1161,65.265 4414.7568,65.4213 Q4415.413,65.5775 4415.9755,65.8744 L4415.9755,68.5931 Q4415.3505,68.015 4414.7568,67.7494 Q4414.163,67.4681 4413.538,67.4681 Q4412.1943,67.4681 4411.5068,68.5463 Q4410.8193,69.6088 4410.8193,71.7025 Q4410.8193,73.7963 4411.5068,74.8744 Q4412.1943,75.9369 4413.538,75.9369 Q4414.163,75.9369 4414.7568,75.6713 Q4415.3505,75.39 4415.9755,74.8119 L4415.9755,77.5306 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.5674" x="4427.2571" y="76.7367">DeviceFlops</text><line style="stroke:#181818;stroke-width:0.5;" x1="4397.88" x2="4514.9513" y1="87.89" y2="87.89"/><ellipse cx="4407.88" cy="101.5384" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.249" x="4416.88" y="104.8851">fp32: float</text><ellipse cx="4407.88" cy="117.8353" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.249" x="4416.88" y="121.182">fp16: float</text><ellipse cx="4407.88" cy="134.1322" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.7783" x="4416.88" y="137.4789">int8: float</text><line style="stroke:#181818;stroke-width:0.5;" x1="4397.88" x2="4514.9513" y1="144.7806" y2="144.7806"/><ellipse cx="4407.88" cy="158.4291" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.0713" x="4416.88" y="161.7757">to_dict(): dict</text></g><!--class RingMemoryWeightedPartitioningStrategy--><g class="entity" data-entity="RingMemoryWeightedPartitioningStrategy" data-source-line="227" data-uid="ent0020" id="entity_RingMemoryWeightedPartitioningStrategy"><rect fill="#F1F1F1" height="64.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="334.376" x="5271.23" y="417.2"/><ellipse cx="5289.0917" cy="433.2" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M5292.0605,438.8406 Q5291.4823,439.1375 5290.8417,439.2781 Q5290.2011,439.4344 5289.498,439.4344 Q5286.998,439.4344 5285.6698,437.7938 Q5284.3573,436.1375 5284.3573,433.0125 Q5284.3573,429.8875 5285.6698,428.2313 Q5286.998,426.575 5289.498,426.575 Q5290.2011,426.575 5290.8417,426.7313 Q5291.498,426.8875 5292.0605,427.1844 L5292.0605,429.9031 Q5291.4355,429.325 5290.8417,429.0594 Q5290.248,428.7781 5289.623,428.7781 Q5288.2792,428.7781 5287.5917,429.8563 Q5286.9042,430.9188 5286.9042,433.0125 Q5286.9042,435.1063 5287.5917,436.1844 Q5288.2792,437.2469 5289.623,437.2469 Q5290.248,437.2469 5290.8417,436.9813 Q5291.4355,436.7 5292.0605,436.1219 L5292.0605,438.8406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="296.0166" x="5303.7277" y="438.0467">RingMemoryWeightedPartitioningStrategy</text><line style="stroke:#181818;stroke-width:0.5;" x1="5272.23" x2="5604.606" y1="449.2" y2="449.2"/><line style="stroke:#181818;stroke-width:0.5;" x1="5272.23" x2="5604.606" y1="457.2" y2="457.2"/><ellipse cx="5282.23" cy="470.8484" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="308.376" x="5291.23" y="474.1951">partition(topology: Topology): List[Partition]</text></g><!--class ShardDownloader--><g class="entity" data-entity="ShardDownloader" data-source-line="232" data-uid="ent0021" id="entity_ShardDownloader"><rect fill="#F1F1F1" height="113.1875" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="374.6875" x="2436.07" y="745.91"/><ellipse cx="2556.6935" cy="761.91" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M2559.6623,767.5506 Q2559.0842,767.8475 2558.4435,767.9881 Q2557.8029,768.1444 2557.0998,768.1444 Q2554.5998,768.1444 2553.2717,766.5038 Q2551.9592,764.8475 2551.9592,761.7225 Q2551.9592,758.5975 2553.2717,756.9413 Q2554.5998,755.285 2557.0998,755.285 Q2557.8029,755.285 2558.4435,755.4413 Q2559.0998,755.5975 2559.6623,755.8944 L2559.6623,758.6131 Q2559.0373,758.035 2558.4435,757.7694 Q2557.8498,757.4881 2557.2248,757.4881 Q2555.881,757.4881 2555.1935,758.5663 Q2554.506,759.6288 2554.506,761.7225 Q2554.506,763.8163 2555.1935,764.8944 Q2555.881,765.9569 2557.2248,765.9569 Q2557.8498,765.9569 2558.4435,765.6913 Q2559.0373,765.41 2559.6623,764.8319 L2559.6623,767.5506 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.9404" x="2577.1935" y="766.7567">ShardDownloader</text><line style="stroke:#181818;stroke-width:0.5;" x1="2437.07" x2="2809.7575" y1="777.91" y2="777.91"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2444.07" y="788.5584"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.5273" x="2456.07" y="794.9051">repo: str</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="2444.07" y="804.8553"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.2305" x="2456.07" y="811.202">download_path: str</text><ellipse cx="2447.07" cy="824.1522" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="247.9941" x="2456.07" y="827.4989">on_progress: AsyncCallbackSystem</text><line style="stroke:#181818;stroke-width:0.5;" x1="2437.07" x2="2809.7575" y1="834.8006" y2="834.8006"/><ellipse cx="2447.07" cy="848.4491" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="348.6875" x="2456.07" y="851.7957">ensure_shard(shard: Shard, engine_class: str): str</text></g><!--class TopologyViz--><g class="entity" data-entity="TopologyViz" data-source-line="240" data-uid="ent0022" id="entity_TopologyViz"><rect fill="#F1F1F1" height="145.7813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="565.8408" x="4638.49" y="729.61"/><ellipse cx="4874.6546" cy="745.61" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4877.6233,751.2506 Q4877.0452,751.5475 4876.4046,751.6881 Q4875.7639,751.8444 4875.0608,751.8444 Q4872.5608,751.8444 4871.2327,750.2038 Q4869.9202,748.5475 4869.9202,745.4225 Q4869.9202,742.2975 4871.2327,740.6413 Q4872.5608,738.985 4875.0608,738.985 Q4875.7639,738.985 4876.4046,739.1413 Q4877.0608,739.2975 4877.6233,739.5944 L4877.6233,742.3131 Q4876.9983,741.735 4876.4046,741.4694 Q4875.8108,741.1881 4875.1858,741.1881 Q4873.8421,741.1881 4873.1546,742.2663 Q4872.4671,743.3288 4872.4671,745.4225 Q4872.4671,747.5163 4873.1546,748.5944 Q4873.8421,749.6569 4875.1858,749.6569 Q4875.8108,749.6569 4876.4046,749.3913 Q4876.9983,749.11 4877.6233,748.5319 L4877.6233,751.2506 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.0117" x="4895.1546" y="750.4567">TopologyViz</text><line style="stroke:#181818;stroke-width:0.5;" x1="4639.49" x2="5203.3308" y1="761.61" y2="761.61"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4646.49" y="772.2584"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.4971" x="4658.49" y="778.6051">topology: Topology</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4646.49" y="788.5553"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170.249" x="4658.49" y="794.902">partitions: List[Partition]</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4646.49" y="804.8522"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.2412" x="4658.49" y="811.1989">console: Console</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4646.49" y="821.1491"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.4404" x="4658.49" y="827.4957">layout: Layout</text><line style="stroke:#181818;stroke-width:0.5;" x1="4639.49" x2="5203.3308" y1="834.7975" y2="834.7975"/><ellipse cx="4649.49" cy="848.4459" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="346.1035" x="4658.49" y="851.7926">update_prompt(request_id: str, prompt: str): void</text><ellipse cx="4649.49" cy="864.7428" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="539.8408" x="4658.49" y="868.0895">update_download_progress(node_id: str, progress: RepoProgressEvent): void</text></g><!--class Server--><g class="entity" data-entity="Server" data-source-line="263" data-uid="ent0032" id="entity_Server"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.9102" x="5239.46" y="778.5"/><ellipse cx="5254.46" cy="794.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M5257.4288,800.1406 Q5256.8506,800.4375 5256.21,800.5781 Q5255.5694,800.7344 5254.8663,800.7344 Q5252.3663,800.7344 5251.0381,799.0938 Q5249.7256,797.4375 5249.7256,794.3125 Q5249.7256,791.1875 5251.0381,789.5313 Q5252.3663,787.875 5254.8663,787.875 Q5255.5694,787.875 5256.21,788.0313 Q5256.8663,788.1875 5257.4288,788.4844 L5257.4288,791.2031 Q5256.8038,790.625 5256.21,790.3594 Q5255.6163,790.0781 5254.9913,790.0781 Q5253.6475,790.0781 5252.96,791.1563 Q5252.2725,792.2188 5252.2725,794.3125 Q5252.2725,796.4063 5252.96,797.4844 Q5253.6475,798.5469 5254.9913,798.5469 Q5255.6163,798.5469 5256.21,798.2813 Q5256.8038,798 5257.4288,797.4219 L5257.4288,800.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.9102" x="5268.46" y="799.3467">Server</text><line style="stroke:#181818;stroke-width:0.5;" x1="5240.46" x2="5316.3702" y1="810.5" y2="810.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="5240.46" x2="5316.3702" y1="818.5" y2="818.5"/></g><!--class PartitioningStrategy--><g class="entity" data-entity="PartitioningStrategy" data-source-line="266" data-uid="ent0036" id="entity_PartitioningStrategy"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172.6084" x="5352.11" y="778.5"/><ellipse cx="5367.11" cy="794.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M5370.0788,800.1406 Q5369.5006,800.4375 5368.86,800.5781 Q5368.2194,800.7344 5367.5163,800.7344 Q5365.0163,800.7344 5363.6881,799.0938 Q5362.3756,797.4375 5362.3756,794.3125 Q5362.3756,791.1875 5363.6881,789.5313 Q5365.0163,787.875 5367.5163,787.875 Q5368.2194,787.875 5368.86,788.0313 Q5369.5163,788.1875 5370.0788,788.4844 L5370.0788,791.2031 Q5369.4538,790.625 5368.86,790.3594 Q5368.2663,790.0781 5367.6413,790.0781 Q5366.2975,790.0781 5365.61,791.1563 Q5364.9225,792.2188 5364.9225,794.3125 Q5364.9225,796.4063 5365.61,797.4844 Q5366.2975,798.5469 5367.6413,798.5469 Q5368.2663,798.5469 5368.86,798.2813 Q5369.4538,798 5370.0788,797.4219 L5370.0788,800.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140.6084" x="5381.11" y="799.3467">PartitioningStrategy</text><line style="stroke:#181818;stroke-width:0.5;" x1="5353.11" x2="5523.7184" y1="810.5" y2="810.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="5353.11" x2="5523.7184" y1="818.5" y2="818.5"/></g><!--class PeerConnection--><g class="entity" data-entity="PeerConnection" data-source-line="270" data-uid="ent0040" id="entity_PeerConnection"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142.6396" x="4466.1" y="1099.36"/><ellipse cx="4481.1" cy="1115.36" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4484.0688,1121.0006 Q4483.4906,1121.2975 4482.85,1121.4381 Q4482.2094,1121.5944 4481.5063,1121.5944 Q4479.0063,1121.5944 4477.6781,1119.9538 Q4476.3656,1118.2975 4476.3656,1115.1725 Q4476.3656,1112.0475 4477.6781,1110.3913 Q4479.0063,1108.735 4481.5063,1108.735 Q4482.2094,1108.735 4482.85,1108.8913 Q4483.5063,1109.0475 4484.0688,1109.3444 L4484.0688,1112.0631 Q4483.4438,1111.485 4482.85,1111.2194 Q4482.2563,1110.9381 4481.6313,1110.9381 Q4480.2875,1110.9381 4479.6,1112.0163 Q4478.9125,1113.0788 4478.9125,1115.1725 Q4478.9125,1117.2663 4479.6,1118.3444 Q4480.2875,1119.4069 4481.6313,1119.4069 Q4482.2563,1119.4069 4482.85,1119.1413 Q4483.4438,1118.86 4484.0688,1118.2819 L4484.0688,1121.0006 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.6396" x="4495.1" y="1120.2067">PeerConnection</text><line style="stroke:#181818;stroke-width:0.5;" x1="4467.1" x2="4607.7396" y1="1131.36" y2="1131.36"/><line style="stroke:#181818;stroke-width:0.5;" x1="4467.1" x2="4607.7396" y1="1139.36" y2="1139.36"/></g><!--reverse link InferenceEngine to MLXDynamicShardInferenceEngine--><g class="link" data-entity-1="InferenceEngine" data-entity-2="MLXDynamicShardInferenceEngine" data-source-line="250" data-uid="lnk23" id="link_InferenceEngine_MLXDynamicShardInferenceEngine"><path codeLine="250" d="M1393.297,851.6384 C1184.307,881.1684 940.17,923.3 711.42,985.28 C705.59,986.86 699.73,988.5 693.84,990.19" fill="none" id="InferenceEngine-backto-MLXDynamicShardInferenceEngine" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="1411.12,849.12,1392.4576,845.6974,1394.1365,857.5793,1411.12,849.12" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link InferenceEngine to TinygradDynamicShardInferenceEngine--><g class="link" data-entity-1="InferenceEngine" data-entity-2="TinygradDynamicShardInferenceEngine" data-source-line="251" data-uid="lnk24" id="link_InferenceEngine_TinygradDynamicShardInferenceEngine"><path codeLine="251" d="M1577.3145,899.3825 C1506.5845,930.6225 1442.01,959.14 1365.24,993.04" fill="none" id="InferenceEngine-backto-TinygradDynamicShardInferenceEngine" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="1593.78,892.11,1574.8904,893.894,1579.7387,904.8709,1593.78,892.11" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link InferenceEngine to DummyInferenceEngine--><g class="link" data-entity-1="InferenceEngine" data-entity-2="DummyInferenceEngine" data-source-line="252" data-uid="lnk25" id="link_InferenceEngine_DummyInferenceEngine"><path codeLine="252" d="M1794.42,909.9 C1794.42,954.13 1794.42,989.54 1794.42,1033.79" fill="none" id="InferenceEngine-backto-DummyInferenceEngine" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="1794.42,891.9,1788.42,909.9,1800.42,909.9,1794.42,891.9" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Discovery to UDPDiscovery--><g class="link" data-entity-1="Discovery" data-entity-2="UDPDiscovery" data-source-line="254" data-uid="lnk26" id="link_Discovery_UDPDiscovery"><path codeLine="254" d="M3000.0771,861.524 C2937.1871,905.304 2856.64,961.38 2776.05,1017.49" fill="none" id="Discovery-backto-UDPDiscovery" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="3014.85,851.24,2996.6491,856.5997,3003.5051,866.4483,3014.85,851.24" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Discovery to TailscaleDiscovery--><g class="link" data-entity-1="Discovery" data-entity-2="TailscaleDiscovery" data-source-line="255" data-uid="lnk27" id="link_Discovery_TailscaleDiscovery"><path codeLine="255" d="M3078.0571,869.1805 C3074.4871,912.9605 3070.54,961.38 3065.97,1017.49" fill="none" id="Discovery-backto-TailscaleDiscovery" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="3079.52,851.24,3072.0769,868.6928,3084.0372,869.6681,3079.52,851.24" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Discovery to ManualDiscovery--><g class="link" data-entity-1="Discovery" data-entity-2="ManualDiscovery" data-source-line="256" data-uid="lnk28" id="link_Discovery_ManualDiscovery"><path codeLine="256" d="M3158.3563,862.3576 C3222.5063,912.7376 3310.58,981.91 3387.17,1042.06" fill="none" id="Discovery-backto-ManualDiscovery" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="3144.2,851.24,3154.6504,867.0763,3162.0621,857.6388,3144.2,851.24" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link PeerHandle to GRPCPeerHandle--><g class="link" data-entity-1="PeerHandle" data-entity-2="GRPCPeerHandle" data-source-line="258" data-uid="lnk29" id="link_PeerHandle_GRPCPeerHandle"><path codeLine="258" d="M3788.9943,937.0901 C3809.1643,956.8301 3817.33,964.8 3837.87,984.9" fill="none" id="PeerHandle-backto-GRPCPeerHandle" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="3776.13,924.5,3784.7976,941.3782,3793.191,932.802,3776.13,924.5" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Node to InferenceEngine--><g class="link" data-entity-1="Node" data-entity-2="InferenceEngine" data-source-line="261" data-uid="lnk30" id="link_Node_InferenceEngine"><path codeLine="261" d="M3509.7643,464.7141 C3199.4243,484.5141 2691.95,530.15 2256.42,633.72 C2173.09,653.54 2084.08,683.61 2006.65,712.85" fill="none" id="Node-backto-InferenceEngine" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3521.74,463.95,3515.4975,460.3401,3509.7643,464.7141,3516.0069,468.3239,3521.74,463.95" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Node to Discovery--><g class="link" data-entity-1="Node" data-entity-2="Discovery" data-source-line="262" data-uid="lnk31" id="link_Node_Discovery"><path codeLine="262" d="M3510.8978,590.6681 C3390.7678,649.9181 3268.18,710.38 3180.48,753.63" fill="none" id="Node-backto-Discovery" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3521.66,585.36,3514.5096,584.4266,3510.8978,590.6681,3518.0483,591.6014,3521.66,585.36" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Node to Server--><g class="link" data-entity-1="Node" data-entity-2="Server" data-source-line="263" data-uid="lnk33" id="link_Node_Server"><path codeLine="263" d="M4081.0742,465.3362 C4443.1042,489.1062 5044.19,547.38 5221.42,680.72 C5253.1,704.56 5267.89,750.44 5274.21,778.28" fill="none" id="Node-backto-Server" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="4069.1,464.55,4074.825,468.9345,4081.0742,465.3362,4075.3492,460.9517,4069.1,464.55" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Node to ShardDownloader--><g class="link" data-entity-1="Node" data-entity-2="ShardDownloader" data-source-line="264" data-uid="lnk34" id="link_Node_ShardDownloader"><path codeLine="264" d="M3509.8047,494.9426 C3312.1547,530.9826 3053.24,589.45 2827.42,680.72 C2785.06,697.84 2741.08,722.82 2704.85,745.63" fill="none" id="Node-backto-ShardDownloader" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3521.61,492.79,3514.9898,489.9312,3509.8047,494.9426,3516.4249,497.8014,3521.61,492.79" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Node to Topology--><g class="link" data-entity-1="Node" data-entity-2="Topology" data-source-line="265" data-uid="lnk35" id="link_Node_Topology"><path codeLine="265" d="M3991.2097,611.7427 C4040.0997,652.0427 4081.61,686.26 4123.76,721" fill="none" id="Node-backto-Topology" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3981.95,604.11,3984.0356,611.0129,3991.2097,611.7427,3989.1241,604.8398,3981.95,604.11" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Node to PartitioningStrategy--><g class="link" data-entity-1="Node" data-entity-2="PartitioningStrategy" data-source-line="266" data-uid="lnk37" id="link_Node_PartitioningStrategy"><path codeLine="266" d="M4080.9967,474.2995 C4362.0367,500.8695 4799.11,550.88 5180.42,633.72 C5250.34,648.91 5274.48,641.62 5334.42,680.72 C5373.81,706.42 5406.75,751.25 5424.43,778.47" fill="none" id="Node-backto-PartitioningStrategy" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="4069.05,473.17,4074.6469,477.717,4080.9967,474.2995,4075.3999,469.7525,4069.05,473.17" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Node to TopologyViz--><g class="link" data-entity-1="Node" data-entity-2="TopologyViz" data-source-line="267" data-uid="lnk38" id="link_Node_TopologyViz"><path codeLine="267" d="M4080.6611,508.3471 C4222.9611,540.1471 4387.05,581.52 4540.42,633.72 C4619.1,660.5 4703.97,697.08 4773.6,729.25" fill="none" id="Node-backto-TopologyViz" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="4068.95,505.73,4073.9332,510.9423,4080.6611,508.3471,4075.6779,503.1348,4068.95,505.73" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Topology to DeviceCapabilities--><g class="link" data-entity-1="Topology" data-entity-2="DeviceCapabilities" data-source-line="269" data-uid="lnk39" id="link_Topology_DeviceCapabilities"><path codeLine="269" d="M4258.4697,895.0844 C4280.2997,949.0544 4304.16,1008.04 4324.47,1058.24" fill="none" id="Topology-backto-DeviceCapabilities" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="4253.97,883.96,4252.5117,891.0221,4258.4697,895.0844,4259.928,888.0223,4253.97,883.96" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Topology to PeerConnection--><g class="link" data-entity-1="Topology" data-entity-2="PeerConnection" data-source-line="270" data-uid="lnk41" id="link_Topology_PeerConnection"><path codeLine="270" d="M4345.6172,891.2009 C4383.6372,920.7309 4415.21,948.6 4448.42,985.28 C4480.98,1021.25 4509.75,1070.33 4525.26,1098.96" fill="none" id="Topology-backto-PeerConnection" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="4336.14,883.84,4338.425,890.6795,4345.6172,891.2009,4343.3322,884.3614,4336.14,883.84" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link ShardDownloader to Shard--><g class="link" data-entity-1="ShardDownloader" data-entity-2="Shard" data-source-line="272" data-uid="lnk42" id="link_ShardDownloader_Shard"><path codeLine="272" d="M2544.3647,866.8016 C2501.6247,901.7916 2455.71,940.94 2409.42,985.28 C2396.06,998.07 2382.36,1011.97 2369.12,1025.83" fill="none" id="ShardDownloader-backto-Shard" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="2553.65,859.2,2546.4735,859.9057,2544.3647,866.8016,2551.5412,866.0959,2553.65,859.2" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link InferenceEngine to Shard--><g class="link" data-entity-1="InferenceEngine" data-entity-2="Shard" data-source-line="273" data-uid="lnk43" id="link_InferenceEngine_Shard"><path codeLine="273" d="M2012.6523,897.5679 C2064.9423,924.0879 2108.73,950.16 2155.42,985.28 C2171.23,997.18 2186.72,1011.19 2201.14,1025.63" fill="none" id="InferenceEngine-backto-Shard" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="2001.95,892.14,2005.4918,898.4214,2012.6523,897.5679,2009.1104,891.2865,2001.95,892.14" style="stroke:#181818;stroke-width:1;"/></g><!--link RingMemoryWeightedPartitioningStrategy to PartitioningStrategy--><g class="link" data-entity-1="RingMemoryWeightedPartitioningStrategy" data-entity-2="PartitioningStrategy" data-source-line="275" data-uid="lnk44" id="link_RingMemoryWeightedPartitioningStrategy_PartitioningStrategy"><path codeLine="275" d="M5438.42,481.82 C5438.42,551.34 5438.42,698.71 5438.42,760.07" fill="none" id="RingMemoryWeightedPartitioningStrategy-to-PartitioningStrategy" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="5438.42,778.07,5444.42,760.07,5432.42,760.07,5438.42,778.07" style="stroke:#181818;stroke-width:1;"/></g><!--link Node to Shard--><g class="link" data-entity-1="Node" data-entity-2="Shard" data-source-line="278" data-uid="lnk45" id="link_Node_Shard"><path codeLine="278" d="M3521.79,452.48 C3134.82,461.88 2457.1,503.9 2299.42,680.72 C2216.43,773.78 2230.6291,920.7972 2253.0291,1020.0472" fill="none" id="Node-to-Shard" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="2254.35,1025.9,2256.2705,1016.2402,2253.2492,1021.0227,2248.4667,1018.0014,2254.35,1025.9" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.0762" x="2300.42" y="807.0669">uses for inference</text></g><!--link Node to Partition--><g class="link" data-entity-1="Node" data-entity-2="Partition" data-source-line="279" data-uid="lnk46" id="link_Node_Partition"><path codeLine="279" d="M4069.15,496.42 C4203.28,529.85 4360.63,586.38 4477.42,680.72 C4501.06,699.82 4516.1342,723.5006 4528.0542,748.3406" fill="none" id="Node-to-Partition" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="4530.65,753.75,4530.3625,743.9053,4528.4868,749.2422,4523.15,747.3664,4530.65,753.75" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.3184" x="4431.42" y="646.7869">maps to shards</text></g><!--link Node to PeerHandle--><g class="link" data-entity-1="Node" data-entity-2="PeerHandle" data-source-line="280" data-uid="lnk47" id="link_Node_PeerHandle"><path codeLine="280" d="M3732.8,604.11 C3722.4,629.65 3714.0022,650.2628 3703.9922,674.8528" fill="none" id="Node-to-PeerHandle" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3701.73,680.41,3708.8281,673.5823,3703.6152,675.779,3701.4185,670.5661,3701.73,680.41" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2134" x="3721.42" y="646.7869">communicates with</text></g><!--link ChatGPTAPI to Node--><g class="link" data-entity-1="ChatGPTAPI" data-entity-2="Node" data-source-line="281" data-uid="lnk48" id="link_ChatGPTAPI_Node"><path codeLine="281" d="M3795.42,209.89 C3795.42,236.36 3795.42,259.74 3795.42,288.57" fill="none" id="ChatGPTAPI-to-Node" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3795.42,294.57,3799.42,285.57,3795.42,289.57,3791.42,285.57,3795.42,294.57" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.4233" x="3796.42" y="261.0369">delegates processing</text></g><!--SRC=[xLdVRzis47xNNy4znLlY0Dk0OJ2A09cJTS7IraYyRa0H2BHqjjb8f4PIJfnr__kEf4HHifGuNTkNxSKsZyTVn- - -kwE_Ic79E92hy-dyzFNBotEIP5IfA3eWfmkb9Kqq-Oag85CZ1XNHMchro0LVWWIUm3bVcNd-YWWvH3t519-Gb2NQ2511f31IQohJ2RasNqUaa28lz8JWV5zF22-EUKgbf5louaMzoCc9dOxcHGQZ-r3fyH4fzAodnIrmrPa4H-sCPkPCiKPb8KSI_Yn1wPYbLlc8j2Tbl2Xrd59DmucDlB9Bh3JLu4o1w-aIZpAmeZF8Koi6PdjY6JDp9cWQ9sj8RWl1kEvU0TNh-W8sWgKzfj_0_iEZlwCkFiwOIiG6vBP2XgPIZmPNqw8Ox4ohcU82GAhH7MKwNeggEK5Bc7DVCgNVpL3o2-Lf1ZVjMNQtrwYw_R5qD00AcgPog2y5bKXMQCJyiCg6uIqbjA0BbZ7DG1dLCokU1jATaOdW799Xep4LLofWDxyG8kittkFph85cUkqkUt0U1JojSVe8B3iGTiuwuDncnihNElvgXStGvqyhGPLPZqCvUOKM1CuDEfAAaGUPMaFgZZvafaHa6PenHgYAJAosemrJJ9jH2lGHoUbzd49X_C8XSbxfxI3nW4m5JoHeQ4YKE1PLaKFdgyi_phQSvYon9kdZsh6rMPoAEsvS7MHblZCly4fLZsddo8xPX9pohMbPOcGFPcmbIIZ209tgZSG983rpD3xkyleuphFxMAybK9nzRhzdQBlpUqXABUIpgNyljdysmNyHJdy-sJhhg5BYV4QZfHxe86OOtslF2cr0vGhCZmpuIg_D3w7mKnG8papwtI807SRcZ6zNagQV5MXpIRb2iiwTrYxWh45t0GSLaFu7rqU1QqEp4kVwTzW9MFRpe_6ipFFjCFm2P6r4GXUnGXHPfZMYDKjJu6rP03Kxzxnk_wVWOyDDaufTc5Fam54JwRoEDh-TpThPsfZZEUgD-7OXfFRcpJ22eibRieL4f2OKpz0Itt9aYZfRCmx-pXvlRZPuqnwdgRf5byVFO8sMi9r8TdF7ZquN0rgaB5C9pU3P9j7ro9WMBBw5hTSrFHoqRpzfaVeCsuv5aWmeBuilR99Nk2RDklO0VIVahKb1bsmLUnhgizN0USF5llnr7v1ha3YmunJLcLzUpQPLlx_-2NcDdvPmX6fkimK2PSTCo4eMoJ5bujW9zZhADQQkirOfU4JGl1hkpHamTotGPw7MdBTeup7DgrOsFAGvTVbjdRO-gkwXOSpKAQN6nlBXxPi22lD7tmwAfa2sKoNrrKZM1zOKwvaiCF7KILfbNATowo_MdbMVzPHaGrLOV-7rISgeJrSvrQM810jhzyvJNQiLsCiCxh66zdMDw74JUy06x4dtLQZ5PPCc4EsTLjR5LbDEMOIX8p5pZuolObDQQJ0giq1yNKd3IU8DUsWcUiiUQhIg7ePu7YXDzRS23cRHk0xv5IK8xYIOywejJwOqonOqkRtU8jtbbO8eADwJ3U6b6b8yH8maw4aV1Q2cyC0UN0hkNKgpR_vcqxzMXMmTefHutKrH7DoJXTVfx89SqYrUfWCMkgf-EPiRSG-jTl4Ksq5Oda139aKn8NUmE3ujYembZhBDDThJe-bc4fRitXUk6gk7tCQKTgX5mOrF4sDh4bH8OKcHAklNoxN50bwiZcqzesfIx51dfOVCf94CZ5ajoJogx40IP7rrgjXwaWZUrp2Fm-JFFySwUzfhSozOTeS1xxfu4sV6-ZKM3mrpj2NSjJrS3-tgKbKZGqh3depsTHW3MI6UlkIMyAh9j8YDCOsaDkeIRye9NJ9RvQikls_IiFhrnCEaTN-xNdZZGmyMjSKwLBu6vzfJnyTuDVP5PqpnzmRYJhPoM1QfyM8Z7eLz60cVO8B0CJ3sn92kO6IFwsT0U_ZVtJWOZCPo6OVQqxHt8FJQt5rjdV2nGCJlbOjirjBUafuL7KowfxKecP0bScwDaBhL56UxZvKDvFnCoPeLlf53BWpbLpZ02GjlifzDemyTdGMjdbjfMNp_NR39PV7j3q4J5_anQFPCUz0A3iH71xVS5SfUsGt_3cornaZU5qhSJdpi6UrodiyqQvqwqRHUYcaqNTb4CtJU9juvg4ieH9CMLPsjz7huxUY8XBnPWweQXL46INBbKh6-06Et-fOfpFNPGvWB1n7JxV69gAnspM3oDkmG6JBvrFsmAJ_TYjAynzhlmFc6_X5fr-Wrzgj1ZRMgStRSjpd-5HfvLhNEDs1hX8PdBpWw6TFKlCjUGUPgPGItYheF52y-ZCTFFDRsZzdZyQr_ODyxIHGrjPbL2WlwRjzkVTlLw9HxKHGa-5QXdVIxB38lX78iqxQOpII_mK7TFVkEPY4lgZBCfjr937s7Xv-NzEQ0E_eczujyYB6xs4thMltj-155NT_rszovjgOdsfDdnkCF9_q7GLF_2bloPl4Uzu4crM3-Lh1FEVQCu_59HJOJKcAMGB0IRbw86fqc9an8Jf5ajN3FJS4ymQrFi0RCyvARV0idlMDw7GMPdD6smqm2bS7AAbMvAkx-7m00]--></g></svg>